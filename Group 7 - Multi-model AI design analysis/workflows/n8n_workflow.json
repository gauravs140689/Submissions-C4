{
  "name": "Design Analysis Webhook",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "design-analysis-suite",
        "responseMode": "lastNode",
        "options": {}
      },
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [200, 260]
    },
    {
      "parameters": {
        "jsCode": "const body = $input.first().json.body || $input.first().json;\nconst jobId = body.job_id || 'unknown';\nconst report = body.report || {};\nconst actionItems = body.action_items || [];\nconst snapshot = report.executive_snapshot || {};\n\ntry {\n  const tickets = await this.helpers.httpRequest({\n    method: 'POST',\n    url: 'http://127.0.0.1:8000/create-tickets',\n    body: {job_id: jobId, providers: ['github', 'jira']},\n    json: true,\n    timeout: 30000\n  });\n  return [{json: {\n    status: 'ok',\n    job_id: jobId,\n    score: snapshot.heuristic_score || 0,\n    total_issues: actionItems.length,\n    tickets: tickets,\n    message: 'Report processed and tickets created via n8n'\n  }}];\n} catch(e) {\n  return [{json: {\n    status: 'ok',\n    job_id: jobId,\n    score: snapshot.heuristic_score || 0,\n    total_issues: actionItems.length,\n    tickets_error: e.message,\n    message: 'Report received but ticket creation failed: ' + e.message\n  }}];\n}"
      },
      "name": "Process and Create Tickets",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [480, 260]
    }
  ],
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "Process and Create Tickets",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  }
}
